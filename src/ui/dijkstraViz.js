import _ from "lodash";
import { getState } from "../index";
import { printCell } from "../lib/canvas";
import { toCell, toLocId } from "../lib/grid";
import * as gfx from "../lib/graphics";

const container = "overlay";

export const renderDijkstraViz = () => {
  const { map, goals } = getState().dijkstra.player;

  const goalIds = goals.map(toLocId);

  _.each(map, (val, locId) => {
    const { x, y } = toCell(locId);

    if (!goalIds.includes(toLocId(locId))) {
      printCell({
        container,
        x,
        y,
        char: charMap[val] || "*",
        halfWidth: false,
        color: colorMap[val] || gfx.colors.default,
      });
    }
  });
};

const charMap = [
  "0",
  "1",
  "2",
  "3",
  "4",
  "5",
  "6",
  "7",
  "8",
  "9",
  "A",
  "B",
  "C",
  "D",
  "E",
  "F",
  "G",
  "H",
  "I",
  "J",
  "K",
  "L",
  "M",
  "N",
  "O",
  "P",
  "Q",
  "R",
  "S",
  "T",
  "U",
  "V",
  "W",
  "X",
  "Y",
  "Z",
  "a",
  "b",
  "c",
  "d",
  "e",
  "f",
  "g",
  "h",
  "i",
  "j",
  "k",
  "l",
  "m",
  "n",
  "o",
  "p",
  "q",
  "r",
  "s",
  "t",
  "u",
  "v",
  "w",
  "x",
  "y",
  "z",
];

const colorMap = [
  0xfafa6e,
  0xedf76f,
  0xe0f470,
  0xd4f171,
  0xc8ed73,
  0xbcea75,
  0xb0e678,
  0xa5e27a,
  0x99de7c,
  0x8eda7f,
  0x83d681,
  0x79d283,
  0x6ecd85,
  0x64c987,
  0x5ac489,
  0x50bf8b,
  0x46bb8c,
  0x3cb68d,
  0x32b18e,
  0x28ac8f,
  0x1ea78f,
  0x12a28f,
  0x039d8f,
  0x00988e,
  0x00938d,
  0x008e8c,
  0x00898a,
  0x008488,
  0x007e86,
  0x007983,
  0x057480,
  0x0e6f7d,
  0x156a79,
  0x1a6575,
  0x1e6071,
  0x225b6c,
  0x255667,
  0x275163,
  0x294d5d,
  0x2a4858,
  0x274a5d,
  0x244b63,
  0x224c69,
  0x214e6e,
  0x214f74,
  0x225079,
  0x25507f,
  0x295184,
  0x2f5188,
  0x36518d,
  0x3e5191,
  0x465095,
  0x4f5098,
  0x584e9a,
  0x614d9c,
  0x6b4b9e,
  0x75499e,
  0x7f469e,
  0x89429e,
  0x933e9d,
  0x9d3a9b,
  0xa73498,
  0xb02e94,
  0xb92690,
  0xc21c8c,
  0xcb0d86,
  0xd30080,
  0xda0079,
  0xe10072,
  0xe7006b,
  0xed0062,
  0xf2005a,
  0xf60051,
  0xf90047,
  0xfc003d,
  0xfe0033,
  0xff0027,
  0xff0018,
  0xff0000,
];
